#  Конфигурационное управление Домашняя работа 
## Кирин Павел ИКБО-23-24
## Вариант 11

____

```
# **Задание**
Разработать инструмент командной строки для учебного конфигурационного
языка, синтаксис которого приведен далее. Этот инструмент преобразует текст из
входного формата в выходной. Синтаксические ошибки выявляются с выдачей
сообщений.
Входной текст на учебном конфигурационном языке принимается из
стандартного ввода. Выходной текст на языке xml попадает в файл, путь к
которому задан ключом командной строки.
Однострочные комментарии:
\ Это однострочный комментарий
Многострочные комментарии:
#[
Это многострочный
комментарий
]#
Числа:
[+-]?\d+\.\d+
Массивы:
(list значение значение значение ... )
Имена:
[_A-Z][_a-zA-Z0-9]*
Значения:
• Числа.
• Строки.
• Массивы.
Строки:
@"Это строка"
Объявление константы на этапе трансляции:
var имя = значение;
Вычисление константного выражения на этапе трансляции (постфиксная
форма), пример:
25
?{имя 1 +}
Результатом вычисления константного выражения является значение.
Для константных вычислений определены операции и функции:
1. Сложение.
2. Вычитание.
3. Умножение.
4. Деление.
5. len().
Все конструкции учебного конфигурационного языка (с учетом их
возможной вложенности) должны быть покрыты тестами. Необходимо показать 3
примера описания конфигураций из разных предметных областей.
```
____


# **Общее описание**
Инструмент командной строки для трансляции учебного конфигурационного языка в формат XML с проверкой синтаксиса, поддержкой комментариев, массивов и вычислением константных выражений на этапе трансляции.

____


# **Описание функций**

- `__init__(self)` - Инициализирует трансформер и создание словаря vars для хранения объявленных
констант и их вычисленных значений.
- `number(self, token)` -  преобразование из строки в тип float.
- `STRING(self, token)` - Обрабатывает строковые значения, удаляя префикс @" и завершающую кавычку,возвращает строку Python.
- `list(self, *items)` - Обрабатывает массивы вида `(list ...)`, собирая все элементы в стандартный Python-список.
- `var_def(self, name, value)` - Обрабатывает объявление константы вида.
- `var NAME = value;` - Сохраняет вычисленное значение в словаре `vars` под именем переменной.
- `postfix_expr(self, *parts)` - Обрабатывает и вычисляет константные выражения в постфиксной форме.
- `instruction(self, item)` - Обрабатывает отдельную инструкцию конфигурационного языка.
- `start(self, *items)` - Корневой обработчик программы.
- `comment(self, *args)` - Обрабатывает однострочные и многострочные комментарии.
- `build_xml_tree(parent, value)` - строит XML-дерево.
- `to_xml(vars_dict)` - Преобразует словарь объявленных переменных в XML-документ.
- `main()` - Главная функция CLI-инструмента.

____

# **Структура проекта**
```
config_translator/
├── cli.py
├── grammar.lark
├── transformer.py
├── xml_writer.py
├── examples/
│   ├── game.conf
│   ├── math.conf
│   └── network.conf
├── tests/
│   └── *.py
└── requirements.txt
```
____

# **Синтаксис**

## Комментарии
### Однострочные:
`\ Это однострочный комментарий`
### Многострочные:
```
#[
Это многострочный
комментарий
]#
```

### Числа:
`[+-]?\d+\.\d+`

### Строки:
`@"Это строка"`

### Массивы:
`(list значение значение значение ...)`

### Имена:
`[_A-Z][_a-zA-Z0-9]*`

### Объявление констант:
```var имя = значение;```

### Константные выражения:
`?{ имя число операция }`

____

# **Генерация XML**
Выходной XML имеет следующую структуру:
```
<config>
    <var name="NAME">
        <number>...</number>
    </var>
</config>
```

____


# **Примеры конфигураций:**

### Математика `(math.conf)`
```
var PI = 3.14;
var R = 10.0;
var AREA = ?{ PI R R * * };
```
### Сети `(network.conf)`
```
var SERVERS = (list @"192.168.1.1" @"192.168.1.2" @"192.168.1.5");
var COUNT = ?{ SERVERS len };
```
### Игры `(game.conf)`
```
var BASE_HEALTH = 100.0;
var MULTIPLIER = 1.5;
var TOTAL_HP = ?{ BASE_HEALTH MULTIPLIER * };
```

____


# **Запуск программы**

### Установка зависимостей
`pip install -r requirements.txt`

Перед первым запуском необходимо установить зависимости.

### Запуск транслятора
Общий вид команды:
`python cli.py --in <input_file.conf> --out <output_file.xml>`
### Примеры запуска:
```python cli.py --in examples\game.conf --out test.xml```

```python cli.py --in examples\math.conf --out test.xml```

```python cli.py --in examples\network.conf --out test.xml```
### Запуск тестов
`pytest`

### Просмотр результата

`type test.xml`

____


# **Примеры использования**\

### game.conf:
![alt text](image-1.png)

### Вывод:
![alt text](image-2.png)

